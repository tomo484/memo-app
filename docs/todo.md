# 実装手順 TODO リスト

## 📋 プロジェクト概要
- **目標**: 5時間以内でのシンプルメモ帳アプリ完成
- **技術スタック**: Next.js 15.3.3 + React 19 + TypeScript + Tailwind CSS v4
- **機能**: 左右分割の1画面構成 + メモのCRUD操作 + 検索機能 + localStorage永続化
- **戦略**: **バックエンド完全実装** → **Figma MCP活用UI実装** → **統合**

---

## 🔧 Phase 1: バックエンド完全実装 (150分)

### 1.1 型定義と基盤ユーティリティ (30分)

#### 型定義 (10分)
- [ ] **T1-1**: `src/types/memo.ts` - 全型定義の作成
  ```typescript
  interface Memo, SaveStatus, AppState, SearchOptions
  ```

#### ユーティリティ関数群 (20分)
- [ ] **T1-2**: `src/utils/constants.ts` - アプリ定数（STORAGE_KEY, DEBOUNCE_DELAY等）
- [ ] **T1-3**: `src/utils/idUtils.ts` - UUID生成関数
- [ ] **T1-4**: `src/utils/dateUtils.ts` - 相対時間表示関数（formatRelativeTime）
- [ ] **T1-5**: `src/utils/textUtils.ts` - テキスト処理関数群
  - タイトル抽出（extractTitle）
  - 文字数カウント（countWords）  
  - 検索マッチング（searchInText）

### 1.2 ストレージレイヤー完全実装 (40分)

#### MemoStorageクラス (25分)
- [ ] **T1-6**: `src/utils/storage.ts` - MemoStorageクラス基本構造
- [ ] **T1-7**: `getMemos()` - localStorage読み込み + JSON解析 + エラーハンドリング
- [ ] **T1-8**: `saveMemo()` - メモ保存 + 容量チェック + エラーハンドリング
- [ ] **T1-9**: `deleteMemo()` - メモ削除 + 存在チェック
- [ ] **T1-10**: `getMemoById()` - 個別メモ取得
- [ ] **T1-11**: `updateMemo()` - メモ更新（部分更新対応）

#### エラーハンドリング強化 (15分)
- [ ] **T1-12**: localStorage容量超過エラーの処理
- [ ] **T1-13**: JSON解析エラー（データ破損）の処理
- [ ] **T1-14**: 存在しないメモへのアクセスエラー処理
- [ ] **T1-15**: ストレージ機能のユニットテスト（簡易）

### 1.3 メモ管理フック完全実装 (50分)

#### useMemos基本実装 (30分)
- [ ] **T1-16**: `src/hooks/useMemos.ts` - フック基本構造 + 状態定義
- [ ] **T1-17**: `createMemo()` - 新規メモ作成ロジック
- [ ] **T1-18**: `updateMemo()` - メモ更新ロジック
- [ ] **T1-19**: `deleteMemo()` - メモ削除ロジック + 状態更新
- [ ] **T1-20**: `getMemoById()` - メモ取得ロジック
- [ ] **T1-21**: 初期データロード処理

#### 検索機能実装 (20分)
- [ ] **T1-22**: `setSearchQuery()` - 検索クエリ状態管理
- [ ] **T1-23**: `filteredMemos` - リアルタイム検索フィルタリング
- [ ] **T1-24**: debounce機能の実装（useCallback + setTimeout）
- [ ] **T1-25**: 検索パフォーマンス最適化（useMemo活用）
- [ ] **T1-26**: `clearSearch()` - 検索クリア機能

### 1.4 自動保存フック実装 (30分)

#### useAutoSave基本実装 (20分)
- [ ] **T1-27**: `src/hooks/useAutoSave.ts` - 自動保存フック基本構造
- [ ] **T1-28**: debounce機能（3秒間隔）の実装
- [ ] **T1-29**: 保存状態管理（idle, typing, saving, saved, error）
- [ ] **T1-30**: 自動保存トリガー（内容変更検知）

#### エラーハンドリングと最適化 (10分)
- [ ] **T1-31**: 保存失敗時のリトライ機能
- [ ] **T1-32**: 内容未変更時のスキップ処理
- [ ] **T1-33**: コンポーネントアンマウント時のクリーンアップ

---

## 🎨 Phase 2: Figma MCP活用 + UI完全実装 (200分)

### 2.1 Figma資産の一括取得 (30分)

#### デザイン資産取得 (20分)
- [ ] **T2-1**: **Figma MCP**: アイコン画像の一括ダウンロード
  - 📄 メモアイコン（48x48px、SVG）
  - 🔍 検索アイコン（24x24px、SVG）
  - 💾 保存アイコン（20x20px、SVG）
  - 🗑️ 削除アイコン（20x20px、SVG）
  - ✏️ 編集中アイコン（20x20px、SVG）
  - ⚠️ エラーアイコン（20x20px、SVG）
- [ ] **T2-2**: `public/icons/` ディレクトリに保存

#### デザインシステム構築 (10分)
- [ ] **T2-3**: **Figma MCP**: カラーパレット情報の抽出
- [ ] **T2-4**: **Figma MCP**: フォントサイズ・スペーシング情報の取得
- [ ] **T2-5**: `tailwind.config.ts` - Figmaデザイン値の設定
- [ ] **T2-6**: `src/styles/globals.css` - カスタムCSS変数の定義

### 2.2 共通UIコンポーネント実装 (40分)

#### 基本コンポーネント (25分)
- [ ] **T2-7**: `src/lib/utils.ts` - cn()クラス名結合関数
- [ ] **T2-8**: `src/components/ui/Button.tsx` - ボタンコンポーネント
  - Primary, Secondary, Danger バリアント
  - サイズ: sm, md, lg
  - Figmaデザイン完全準拠
- [ ] **T2-9**: `src/components/ui/Card.tsx` - カードコンポーネント
- [ ] **T2-10**: `src/components/ui/Modal.tsx` - モーダルコンポーネント
- [ ] **T2-11**: `src/components/ui/Input.tsx` - 入力フィールドコンポーネント

#### レイアウトコンポーネント (15分)
- [ ] **T2-12**: `src/components/layout/Header.tsx` - ヘッダーコンポーネント
  - アプリタイトル: "📝 Simple Notepad"
  - 新規メモボタン: "+ New Note"
  - Figmaデザイン準拠のスタイリング
- [ ] **T2-13**: `src/app/layout.tsx` - ルートレイアウト更新

### 2.3 左サイドバー実装 (60分)

#### 検索バーコンポーネント (20分)
- [ ] **T2-14**: `src/components/memo/MemoSearchBar.tsx` - 検索バー実装
  - 🔍 アイコン（Figma取得画像使用）
  - プレースホルダー: "Search notes"
  - グレー背景 (#E8EDF2)、角丸デザイン
  - リアルタイム検索（debounce機能連携）

#### メモカードコンポーネント (25分)
- [ ] **T2-15**: `src/components/memo/MemoCard.tsx` - メモカード実装
  - 📄 アイコン（48x48px、グレー背景の円形）
  - タイトル表示（先頭20文字 + 省略記号）
  - 更新日時（相対時間: "2 days ago"）
  - 文字数表示（"120 words"）
  - 選択状態のハイライト表示
  - ホバー効果（背景色変化）

#### サイドバー統合 (15分)
- [ ] **T2-16**: `src/components/memo/MemoSidebar.tsx` - 左サイドバー全体
  - "Notes" セクションタイトル
  - 検索バー + メモリストの統合
  - 320px固定幅、スクロール対応
  - 空状態表示（"Start writing your first note"）

### 2.4 右エディタエリア実装 (70分)

#### メインエディタコンポーネント (35分)
- [ ] **T2-17**: `src/components/memo/MemoEditor.tsx` - 右エディタエリア全体
- [ ] **T2-18**: エディタヘッダー（選択中メモのタイトル表示、28px太字）
- [ ] **T2-19**: フルスクリーンテキストエリア
  - ボーダーなし（シームレスデザイン）
  - 自動フォーカス（メモ選択時）
  - 自動リサイズ（内容に応じて高さ調整）
  - プレースホルダー: "Start typing..."
  - フォント: システムフォント、16px、行間1.6
- [ ] **T2-20**: 空状態表示（メモ未選択時）
  - 大きな📝アイコン
  - "Select a note to start editing"
  - "Or create a new note to get started"

#### ステータスバー実装 (20分)
- [ ] **T2-21**: エディタステータスバーの基本構造
- [ ] **T2-22**: 保存状態表示（アイコン + テキスト）
  - 💾 "Auto-saved" (保存完了時)
  - ✏️ "Typing..." (編集中)
  - ⚠️ "Save failed" (エラー時)
- [ ] **T2-23**: リアルタイム文字数カウンター（"XXX characters"）
- [ ] **T2-24**: 削除ボタン（🗑️ "Delete"）
  - 右端配置、危険色（赤系）
  - 新規メモ時は非表示

#### 自動保存UI連携 (15分)
- [ ] **T2-25**: useAutoSaveフックとの連携
- [ ] **T2-26**: 保存状態のリアルタイム表示
- [ ] **T2-27**: エラー時のユーザーフィードバック

---

## 🔗 Phase 3: 統合・機能連携・テスト (50分)

### 3.1 メイン画面統合 (25分)

#### 左右分割レイアウト実装 (15分)
- [ ] **T3-1**: `src/app/page.tsx` - メイン画面の左右分割レイアウト
- [ ] **T3-2**: ヘッダー + サイドバー + エディタの統合
- [ ] **T3-3**: 320px固定サイドバー + 残り幅エディタ
- [ ] **T3-4**: 分割線（薄いグレーボーダー）のスタイリング

#### 状態管理統合 (10分)
- [ ] **T3-5**: useMemos フックとの全面連携
- [ ] **T3-6**: メモ選択時の状態変化（サイドバー⇔エディタ）
- [ ] **T3-7**: 新規メモボタン（"+ New Note"）の実装

### 3.2 削除機能とモーダル (15分)

#### 削除確認モーダル (10分)
- [ ] **T3-8**: 削除確認ダイアログ（Figmaデザイン準拠）
  ```
  ⚠️ Delete this note?
  This action cannot be undone.
  [Cancel] [Delete]
  ```
- [ ] **T3-9**: モーダル表示/非表示制御

#### 削除機能統合 (5分)
- [ ] **T3-10**: 削除ボタンの表示制御（新規メモ時は非表示）
- [ ] **T3-11**: 削除後の状態管理（エディタを空状態に戻す）
- [ ] **T3-12**: 削除後のサイドバー更新

### 3.3 最終テスト・調整 (10分)
- [ ] **T3-13**: 全機能の動作確認（作成・編集・削除・検索）
- [ ] **T3-14**: 自動保存機能のテスト
- [ ] **T3-15**: 検索機能のテスト（リアルタイム、debounce）
- [ ] **T3-16**: ページリロード後のデータ永続性確認
- [ ] **T3-17**: レスポンシブデザイン確認（デスクトップ・タブレット）
- [ ] **T3-18**: 最終バグ修正とポリッシュ

---

## ⏰ 時間配分サマリー

| Phase | 時間 | 内容 | 重要度 |
|--------|------|------|--------|
| Phase 1 | 150分 | **バックエンド完全実装** | 🔴 最重要 |
| Phase 2 | 200分 | **Figma MCP + UI実装** | 🟡 重要 |
| Phase 3 | 50分 | **統合・テスト** | 🟢 必須 |
| **合計** | **400分 (6.7時間)** | **バッファ含む** | |

## 🎯 5時間以内に調整する場合の優先度

### 🔴 絶対に削れない（Phase 1全体）
- バックエンドロジック（150分）
- 基本的なUI実装（100分）

### 🟡 時間調整可能
- Figma MCP詳細活用（30分 → 15分に短縮）
- UI詳細調整（50分 → 30分に短縮）
- レスポンシブ対応（最小限に）

### 🟢 最悪スキップ可能
- 高度なアニメーション
- 詳細なアクセシビリティ対応
- エラーハンドリングの詳細化

---

## 🚀 この戦略の利点

### 1. **リスク最小化**
- 最も複雑なバックエンドロジックを最初に完成
- UI実装はFigma MCPにより予測可能

### 2. **開発効率最大化**  
- ロジックとUIの完全分離
- Figmaデザイン資産の一括活用
- デバッグの単純化

### 3. **品質保証**
- バックエンドロジックの十分なテスト時間
- Figmaデザインとの完全一致
- 段階的な統合によるバグ最小化

---

## 🔧 実装時の重要ポイント

### Phase 1（バックエンド）
1. **型安全性**: TypeScript型定義を最初に完璧に作成
2. **テスト駆動**: 各関数の動作を簡易テストで確認
3. **エラーハンドリング**: localStorage制限を考慮した堅牢な実装

### Phase 2（UI + Figma MCP）
1. **Figma準拠**: MCPで取得した資産を正確に使用
2. **コンポーネント分離**: 再利用可能な粒度で設計
3. **状態連携**: バックエンドフックとのクリーンな接続

### Phase 3（統合）
1. **段階的統合**: 小さな単位で機能を接続
2. **実用テスト**: 実際のユーザー操作フローでテスト
3. **パフォーマンス**: 不要な再レンダリングの回避

---

## ✅ 完了チェックリスト

### Phase 1 完了基準
- [ ] 全てのCRUD操作が単独で動作する
- [ ] 検索機能が期待通りにフィルタリングする
- [ ] 自動保存が正確に動作する
- [ ] エラーケースが適切に処理される

### Phase 2 完了基準  
- [ ] Figmaデザインと視覚的に一致している
- [ ] 全コンポーネントが独立して動作する
- [ ] レスポンシブレイアウトが機能する

### Phase 3 完了基準
- [ ] 左右分割レイアウトが完全に機能する
- [ ] 全機能が統合された状態で動作する
- [ ] データ永続性が保証されている
- [ ] 直感的なUX操作が実現されている

---

## 📝 実装開始時の準備

### 事前確認事項
1. **Figma URL**: デザインファイルへのアクセス確認
2. **開発環境**: Next.js 15.3.3 + React 19 + TypeScript + Tailwind CSS v4
3. **pnpm**: パッケージマネージャーの確認
4. **Figma MCP**: アクセストークンの設定確認

### 開始手順
1. **Phase 1**: `src/types/memo.ts`から開始
2. **テスト環境**: 各フェーズ完了時に動作確認
3. **Figma連携**: Phase 2開始前にMCP接続テスト
4. **段階的統合**: Phase 3で慎重に機能統合

この戦略で**5時間以内**での高品質なメモアプリ完成を目指します！ 